{
  "dashboard": {
    "title": "OpenBank System Dashboard",
    "panels": [
      {
        "title": "API Request Rate",
        "type": "graph",
        "targets": [
          {
            "expr": "rate(openbank_api_requests_total[5m])",
            "legendFormat": "{{method}} {{route}}",
            "refId": "A"
          }
        ]
      },
      {
        "title": "API Latency (95th percentile)",
        "type": "graph",
        "targets": [
          {
            "expr": "histogram_quantile(0.95, rate(openbank_api_latency_seconds_bucket[5m]))",
            "legendFormat": "{{route}}",
            "refId": "A"
          }
        ]
      },
      {
        "title": "Active Users",
        "type": "stat",
        "targets": [
          {
            "expr": "openbank_active_users",
            "refId": "A"
          }
        ]
      },
      {
        "title": "MongoDB Connections",
        "type": "graph",
        "targets": [
          {
            "expr": "mongodb_connections{instance=\"mongodb-exporter:9216\"}",
            "legendFormat": "{{state}}",
            "refId": "A"
          }
        ]
      },
      {
        "title": "System Resources",
        "type": "row",
        "panels": [
          {
            "title": "CPU Usage",
            "type": "gauge",
            "targets": [
              {
                "expr": "100 - (avg by (instance) (rate(node_cpu_seconds_total{mode=\"idle\"}[5m])) * 100)",
                "legendFormat": "{{instance}}",
                "refId": "A"
              }
            ]
          },
          {
            "title": "Memory Usage",
            "type": "gauge",
            "targets": [
              {
                "expr": "(node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes * 100",
                "legendFormat": "{{instance}}",
                "refId": "A"
              }
            ]
          }
        ]
      }
    ]
  }
}